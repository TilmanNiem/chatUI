<div class="py-2">
  @if(loading() === false ) {
    <div class="px-3 flex flex-row justify-between items-center">
      <p class="font-bold text-2xl">Chats</p>
      <p-button (click)="showCreateChatDialog()" label="Create chat"></p-button>
    </div>
    <p-divider></p-divider>
    <div class="flex flex-col gap-3 px-3">
      @for(chat of chatPreviews(); track $index){
        <app-chat-preview-field [preview]="chat"></app-chat-preview-field>
      }
    </div>
  } @else {
    <div class="flex items-center"></div>
    <p-progressSpinner></p-progressSpinner>
  }
</div>


<p-dialog [(visible)]="showDialog" [modal]="true" [style]="{ width: '25rem' }">
    <ng-template #header>
        <div class="inline-flex items-center justify-center gap-2">
            <span class="font-bold whitespace-nowrap">Create chat</span>
        </div>
    </ng-template>
    <div class="flex">
      <p-checkbox inputId="isGroup" [field]="chatCreateForm.isGroup" />
      <label for="isGroup" class="ml-2"> Create a group chat </label>
    </div>
    @if(chatCreateForm.isGroup().value()) {
      <div class="flex items-center gap-4 mb-4">
        <label for="groupName" class="font-semibold w-24">GroupName</label>
        <input pInputText id="groupName" class="flex-auto" autocomplete="off" />
    </div>
    }
    @for(user of chatCreateForm.userIds().value(); track $index) {
      <div class="flex items-center gap-4 mb-4">
        <label for="username" class="font-semibold w-24">Username</label>
        <input pInputText id="username" class="flex-auto" autocomplete="off" />
      </div>
    }
    

    @if(chatCreateForm.isGroup().value()) {
      <div class="flex justify-end items-center gap-4 mb-4">
        <p-button label="Add user" icon="pi pi-plus-circle" iconPos="right" (onClick)="incrementUserCount()" />
    </div>
    }
    <ng-template #footer>
        <p-button label="Cancel" [text]="true" severity="secondary" (click)="showDialog.set(false)"  />
        <p-button label="Save" (onClick)="onSubmit()" [outlined]="true" severity="secondary" (click)="showDialog.set(false)" />
    </ng-template>
</p-dialog>
